@template nms-base

FROM debian:jessie

ENV container docker
MAINTAINER "Kristian" <kly@kly.no>
RUN systemctl set-default basic.target
RUN apt-get update && apt-get -y install	\
	 wget					\
	 vim					\
	 man					\
	 build-essential			\
	 net-tools				\
	 bash-completion			\
	 git-core				\
	 autoconf				\
	 netcat					\
	 libwww-perl				\
	 libmicrohttpd-dev			\
	 libcurl4-gnutls-dev			\
	 libedit-dev				\
	 libpcre3-dev				\
	 libncurses5-dev			\
	 python-demjson				\
	 python-docutils			\
	 libtool				\
	 nodejs					\
	 httpie					\
	 locales				\
	 screen					\
	 pkg-config	

VOLUME [ "/sys/fs/cgroup" ]
VOLUME [ "/run" ]
VOLUME [ "/run/lock" ]
RUN echo en_US.UTF8 UTF-8 > /etc/locale.gen
RUN locale-gen
RUN echo 'LANG="en_US.utf8"' > /etc/default/locale
RUN echo . /etc/default/locale >> /root/.bashrc
RUN echo export LANG >> /root/.bashrc
RUN echo . /etc/bash_completion >> /root/.bashrc
ENV TERM=rxvt-unicode
ADD .vimrc /root/.vimrc
RUN rm /etc/apt/apt.conf.d/docker-clean
RUN systemctl mask dev-hugepages.mount sys-fs-fuse-connections.mount
RUN git clone https://github.com/tech-server/tgmanage.git root/tgmanage

CMD ["/sbin/init"]

@template nms-front
FROM nms-base
RUN apt-get -y install libcapture-tiny-perl libcgi-pm-perl libcommon-sense-perl libdata-dumper-simple-perl libdbi-perl libdigest-perl libgd-perl libgeo-ip-perl libhtml-parser-perl libhtml-template-perl libimage-magick-perl libimage-magick-q16-perl libjson-perl libjson-xs-perl libnetaddr-ip-perl libnet-cidr-perl libnet-ip-perl libnet-openssh-perl libnet-oping-perl libnet-rawip-perl libnet-telnet-cisco-perl libnet-telnet-perl libsnmp-perl libsocket6-perl libsocket-perl libswitch-perl libtimedate-perl perl perl-base perl-modules

RUN cd /root/tgmanage/ && tools/get_mibs.sh

